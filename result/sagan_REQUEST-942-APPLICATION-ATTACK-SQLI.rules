alert any any any -> any any (msg:"None"; pcre:"^[0-0]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942011; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-0]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942012; rev:1;)
None
alert any any any -> any any (msg:"SQL Injection Attack: Common DB Names Detected"; pcre:"(?i)\b(?:d(?:atabas|b_nam)e[^0-9A-Z_a-z]*\(|(?:information_schema|m(?:aster\.\.sysdatabases|s(?:db|ys(?:ac(?:cess(?:objects|storage|xml)|es)|modules2?|(?:object|querie|relationship)s))|ysql\.db)|northwind|pg_(?:catalog|toast)|tempdb)\b|s(?:chema(?:_name\b|[^0-9A-Z_a-z]*\()|(?:qlite_(?:temp_)?master|ys(?:aux|\.database_name))\b))"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942140; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack: SQL function name detected"; pcre:"(?i)\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|iel(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert_tz)?)|t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|s_(?:de|en)crypt)|ump)|e(?:n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|insert|object(?:_(?:agg|keys))?|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|inser_id)|case|east|i(?:kely|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2))|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:lygon|w)|rocedure_analyse)|qu(?:ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp))|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\("; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942151; rev:1;)
alert any any any -> any any (msg:"Detects blind sqli tests using sleep() or benchmark()"; pcre:"(?i:sleep\(\s*?\d*?\s*?\)|benchmark\(.*?\,.*?\))"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942160; rev:1;)
alert any any any -> any any (msg:"Detects SQL benchmark and sleep injection attempts including conditional queries"; pcre:"(?i)(?:select|;)[\s\x0b]+(?:benchmark|if|sleep)[\s\x0b]*?\([\s\x0b]*?\(?[\s\x0b]*?[0-9A-Z_a-z]+"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942170; rev:1;)
alert any any any -> any any (msg:"Detects MSSQL code execution and information gathering attempts"; pcre:"(?i)[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942190; rev:1;)
alert any any any -> any any (msg:"Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \"magic number\" crash"; pcre:"^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2250738585072007e-308|2.2250738585072011e-308|1e309)$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942220; rev:1;)
alert any any any -> any any (msg:"Detects conditional SQL injection attempts"; pcre:"(?i)[\s\x0b\(\)]case[\s\x0b]+when.*?then|\)[\s\x0b]*?like[\s\x0b]*?\(|select.*?having[\s\x0b]*?[^\s\x0b]+[\s\x0b]*?[^\s\x0b0-9A-Z_a-z]|if[\s\x0b]?\([0-9A-Z_a-z]+[\s\x0b]*?[<->~]"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942230; rev:1;)
alert any any any -> any any (msg:"Detects MySQL charset switch and MSSQL DoS attempts"; pcre:"(?i)alter[\s\x0b]*?[0-9A-Z_a-z]+.*?char(?:acter)?[\s\x0b]+set[\s\x0b]+[0-9A-Z_a-z]+|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942240; rev:1;)
alert any any any -> any any (msg:"Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections"; pcre:"(?i:merge.*?using\s*?\(|execute\s*?immediate\s*?[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942250; rev:1;)
alert any any any -> any any (msg:"Looking for basic sql injection. Common attack string for mysql, oracle and others"; pcre:"(?i)union.*?select.*?from"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942270; rev:1;)
alert any any any -> any any (msg:"Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts"; pcre:"(?i)select[\s\x0b]*?pg_sleep|waitfor[\s\x0b]*?delay[\s\x0b]?[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942280; rev:1;)
alert any any any -> any any (msg:"Finds basic MongoDB SQL injection attempts"; pcre:"(?i)\[?\$(?:n(?:e|in?|o[rt])|e(?:q|xists|lemMatch)|l(?:te?|ike)|mod|a(?:ll|nd)|(?:s(?:iz|lic)|wher)e|t(?:ype|ext)|x?or|div|between|regex|jsonSchema)\]?"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942290; rev:1;)
alert any any any -> any any (msg:"Detects MySQL and PostgreSQL stored procedure/function injections"; pcre:"(?i)create[\s\x0b]+(?:function|procedure)[\s\x0b]*?[0-9A-Z_a-z]+[\s\x0b]*?\([\s\x0b]*?\)[\s\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\s\x0b]*?[0-9A-Z_a-z]+|iv[\s\x0b]*?\([\+\-]*[\s\x0b\.0-9]+,[\+\-]*[\s\x0b\.0-9]+\))|exec[\s\x0b]*?\([\s\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\s\x0b]+analyse)[\s\x0b]*?\(|;[\s\x0b]*?(?:declare|open)[\s\x0b]+[\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\s\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942320; rev:1;)
alert any any any -> any any (msg:"Detects MySQL UDF injection and other data/structure manipulation attempts"; pcre:"(?i)create[\s\x0b]+function[\s\x0b].+[\s\x0b]returns|;[\s\x0b]*?(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\b[\s\x0b]*?[\(\[]?[0-9A-Z_a-z]{2,}"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942350; rev:1;)
alert any any any -> any any (msg:"Detects concatenated basic SQL injection and SQLLFI attempts"; pcre:"(?i)\b(?:(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\s\x0b]+(?:char|group_concat|load_file)\b[\s\x0b]*\(?|end[\s\x0b]*?\);)|[\s\x0b\(]load_file[\s\x0b]*?\(|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942360; rev:1;)
alert any any any -> any any (msg:"MySQL in-line comment detected"; pcre:"(?i)/\*[\s\x0b]*?[!\+](?:[\s\x0b\(\)\-0-9=A-Z_a-z]+)?\*/"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942500; rev:1;)
alert any any any -> any any (msg:"SQL Authentication bypass (split query)"; pcre:"^(?:[^']*'|[^\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942540; rev:1;)
alert any any any -> any any (msg:"MySQL Scientific Notation payload detected"; pcre:"(?i)1\.e[\(\),]"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942560; rev:1;)
alert any any any -> any any (msg:"JSON-Based SQL Injection"; pcre:"[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942550; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-1]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942013; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-1]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942014; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack: SQL Operator Detected"; pcre:"(?i)[!=]=|&&|\|\||->|>[=>]|<(?:[<=]|>(?:[\s\x0b]+binary)?)|\b(?:(?:xor|r(?:egexp|like)|i(?:snull|like)|notnull)\b|collate(?:[^0-9A-Z_a-z]*?(?:U&)?[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942120; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack: SQL Boolean-based attack detected"; pcre:"(?i)[\s\x0b\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942130; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"None"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:None; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack: SQL Boolean-based attack detected"; pcre:"(?i)[\s\x0b\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942131; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"None"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:None; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack: SQL function name detected"; pcre:"(?i)\b(?:json(?:_[0-9A-Z_a-z]+)?|a(?:bs|(?:cos|sin)h?|tan[2h]?|vg)|c(?:eil(?:ing)?|h(?:a(?:nges|r(?:set)?)|r)|o(?:alesce|sh?|unt)|ast)|d(?:e(?:grees|fault)|a(?:te|y))|exp|f(?:loor(?:avg)?|ormat|ield)|g(?:lob|roup_concat)|h(?:ex|our)|i(?:f(?:null)?|if|n(?:str)?)|l(?:ast(?:_insert_rowid)?|ength|ike(?:l(?:ihood|y))?|n|o(?:ad_extension|g(?:10|2)?|wer(?:pi)?|cal)|trim)|m(?:ax|in(?:ute)?|o(?:d|nth))|n(?:ullif|ow)|p(?:i|ow(?:er)?|rintf|assword)|quote|r(?:a(?:dians|ndom(?:blob)?)|e(?:p(?:lace|eat)|verse)|ound|trim|ight)|s(?:i(?:gn|nh?)|oundex|q(?:lite_(?:compileoption_(?:get|used)|offset|source_id|version)|rt)|u(?:bstr(?:ing)?|m)|econd|leep)|t(?:anh?|otal(?:_changes)?|r(?:im|unc)|ypeof|ime)|u(?:n(?:icode|likely)|(?:pp|s)er)|zeroblob|bin|v(?:alues|ersion)|week|year)[^0-9A-Z_a-z]*\("; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942150; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL authentication bypass attempts 1/3"; pcre:"(?i)(?:/\*)+[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942180; rev:1;)
alert any any any -> any any (msg:"Detects MySQL comment-/space-obfuscated injections and backtick termination"; pcre:"(?i),.*?[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942200; rev:1;)
alert any any any -> any any (msg:"Detects chained SQL injection attempts 1/2"; pcre:"(?i)(?:&&|\|\||and|between|div|like|n(?:and|ot)|(?:xx?)?or)[\s\x0b\(]+[0-9A-Z_a-z]+[\s\x0b\)]*?[!\+=]+[\s\x0b0-9]*?[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942210; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL authentication bypass attempts 2/3"; pcre:"(?i)[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942260; rev:1;)
alert any any any -> any any (msg:"Detects MySQL comments, conditions and ch(a)r injections"; pcre:"(?i)\)[\s\x0b]*?when[\s\x0b]*?[0-9]+[\s\x0b]*?then|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942300; rev:1;)
alert any any any -> any any (msg:"Detects chained SQL injection attempts 2/2"; pcre:"(?i)(?:\([\s\x0b]*?select[\s\x0b]*?[0-9A-Z_a-z]+|coalesce|order[\s\x0b]+by[\s\x0b]+if[0-9A-Z_a-z]*?)[\s\x0b]*?\(|\*/from|\+[\s\x0b]*?[0-9]+[\s\x0b]*?\+[\s\x0b]*?@|[0-9A-Z_a-z][\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942310; rev:1;)
alert any any any -> any any (msg:"Detects classic SQL injection probings 1/3"; pcre:"(?i)[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942330; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL authentication bypass attempts 3/3"; pcre:"(?i)in[\s\x0b]*?\(+[\s\x0b]*?select|(?:(?:N?AND|X?X?OR|DIV|LIKE|BETWEEN|NOT)[\s\x0b]+|(?:\|\||&&)[\s\x0b]*)[\s\x0b\+0-9A-Z_a-z]+(?:regexp[\s\x0b]*?\(|sounds[\s\x0b]+like[\s\x0b]*?[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942340; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL injection based on keyword alter or union"; pcre:"(?i:^[\W\d]+\s*?(?:alter|union)\b)"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942361; rev:1;)
alert any any any -> any any (msg:"Detects concatenated basic SQL injection and SQLLFI attempts"; pcre:"(?i)(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\s\x0b]+(?:char|group_concat|load_file)[\s\x0b]?\(?|end[\s\x0b]*?\);|[\s\x0b\(]load_file[\s\x0b]*?\(|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942362; rev:1;)
alert any any any -> any any (msg:"Detects classic SQL injection probings 2/3"; pcre:"(?i)[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942370; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack"; pcre:"(?i)\b(?:having\b(?:[\s\x0b]+(?:[0-9]{1,10}|'[^=]{1,10}')[\s\x0b]*?[<->]| ?(?:[0-9]{1,10} ?[<->]+|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942380; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack"; pcre:"(?i)\b(?:or\b(?:[\s\x0b]?(?:[0-9]{1,10}|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942390; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack"; pcre:"(?i)\band\b(?:[\s\x0b]+(?:[0-9]{1,10}[\s\x0b]*?[<->]|'[^=]{1,10}')| ?(?:[0-9]{1,10}|[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942400; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack"; pcre:"(?i)\b(?:a(?:(?:b|co)s|dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:in|cii(?:str)?)|tan2?|vg)|b(?:enchmark|i(?:n(?:_to_num)?|t_(?:and|count|length|x?or)))|c(?:ast|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|o(?:alesce|ercibility|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|(?:un)?t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff)?)|y(?:name|of(?:month|week|year))?)|count|e(?:code|(?:faul|s_(?:de|en)cryp)t|grees)|ump)|e(?:lt|nc(?:ode|rypt)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:eld(?:_in_set)?|nd_in_set)|loor|o(?:rmat|und_rows)|rom_(?:base64|days|unixtime))|g(?:et_(?:format|lock)|r(?:eates|oup_conca)t)|h(?:ex(?:toraw)?|our)|i(?:f(?:null)?|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)?|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null)?)|l(?:ast(?:_(?:day|insert_id))?|case|e(?:(?:as|f)t|ngth)|n|o(?:ad_file|ca(?:l(?:timestamp)?|te)|g(?:10|2)?|wer)|pad|trim)|m(?:a(?:ke(?:date|_set)|ster_pos_wait|x)|d5|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:d|nth(?:name)?))|n(?:ame_const|o(?:t_in|w)|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:assword|eriod_(?:add|diff)|g_sleep|i|o(?:sition|w(?:er)?)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wto(?:hex|nhex(?:toraw)?))|e(?:lease_lock|p(?:eat|lace)|verse)|ight|o(?:und|w_count)|pad|trim)|s(?:chema|e(?:c(?:ond|_to_time)|ssion_user)|ha[12]?|ig?n|leep|oundex|pace|qrt|t(?:d(?:dev(?:_(?:po|sam)p)?)?|r(?:cmp|_to_date))|u(?:b(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|m)|ys(?:date|tem_user))|t(?:an|ime(?:diff|_(?:format|to_sec)|stamp(?:add|diff)?)?|o_(?:base64|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|ix_timestamp)|p(?:datexml|per)|ser|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|v(?:a(?:lues|r(?:iance|_(?:po|sam)p))|ersion)|we(?:ek(?:day|ofyear)?|ight_string)|xmltype|year(?:week)?)[^0-9A-Z_a-z]*?\("; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942410; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack"; pcre:"(?i)autonomous_transaction|(?:current_use|n?varcha|tbcreato)r|db(?:a_users|ms_java)|open(?:owa_util|query|rowset)|s(?:p_(?:(?:addextendedpro|sqlexe)c|execute(?:sql)?|help|is_srvrolemember|makewebtask|oacreate|p(?:assword|repare)|replwritetovarbin)|ql_(?:longvarchar|variant))|utl_(?:file|http)|xp_(?:availablemedia|(?:cmdshel|servicecontro)l|dirtree|e(?:numdsn|xecresultset)|filelist|loginconfig|makecab|ntsec(?:_enumdomains)?|reg(?:addmultistring|delete(?:key|value)|enum(?:key|value)s|re(?:ad|movemultistring)|write)|terminate(?:_process)?)"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942470; rev:1;)
alert any any any -> any any (msg:"SQL Injection Attack"; pcre:"(?i)\b(?:(?:d(?:bms_[0-9A-Z_a-z]+\.|elete\b[^0-9A-Z_a-z]*?\bfrom)|(?:group\b.*?\bby\b.{1,100}?\bhav|overlay\b[^0-9A-Z_a-z]*?\(.*?\b[^0-9A-Z_a-z]*?plac)ing|in(?:ner\b[^0-9A-Z_a-z]*?\bjoin|sert\b[^0-9A-Z_a-z]*?\binto|to\b[^0-9A-Z_a-z]*?\b(?:dump|out)file)|load\b[^0-9A-Z_a-z]*?\bdata\b.*?\binfile|s(?:elect\b.{1,100}?\b(?:(?:.*?\bdump\b.*|(?:count|length)\b.{1,100}?)\bfrom|(?:data_typ|from\b.{1,100}?\bwher)e|instr|to(?:_(?:cha|numbe)r|p\b.{1,100}?\bfrom))|ys_context)|u(?:nion\b.{1,100}?\bselect|tl_inaddr))\b|print\b[^0-9A-Z_a-z]*?@@)|(?:collation[^0-9A-Z_a-z]*?\(a|@@version|;[^0-9A-Z_a-z]*?\b(?:drop|shutdown))\b|'(?:dbo|msdasql|s(?:a|qloledb))'"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942480; rev:1;)
alert any any any -> any any (msg:"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)"; pcre:"((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942430; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"[a-zA-Z0-9_-]{61,61}"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942441; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"[a-zA-Z0-9_-]{91,91}"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942442; rev:1;)
alert any any any -> any any (msg:"SQL Comment Sequence Detected"; pcre:"/\*!?|\*/|[';]--|--(?:[\s\x0b]|[^\-]*?-)|[^&\-]#.*?[\s\x0b]|;?\x00"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942440; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^ey[\-0-9A-Z_a-z]+\.ey[\-0-9A-Z_a-z]+\.[\-0-9A-Z_a-z]+$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:None; rev:1;)
alert any any any -> any any (msg:"SQL Hex Encoding Identified"; pcre:"(?i:\b0x[a-f\d]{3,})"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942450; rev:1;)
alert any any any -> any any (msg:"SQLi bypass attempt by ticks or backticks detected"; pcre:"(?:`(?:(?:[\w\s=_\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942510; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL authentication bypass attempts 4.0/4"; pcre:"(?i)[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942520; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL authentication bypass attempts 4.1/4"; pcre:"(?i)^(?:[^']*?(?:'[^']*?'[^']*?)*?'|[^\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942521; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^(?:and|or)$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:None; rev:1;)
alert any any any -> any any (msg:"Detects basic SQL authentication bypass attempts 4.1/4"; pcre:"^.*?\x5c['\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942522; rev:1;)
None
alert any any any -> any any (msg:"SQL Injection Attack: SQL function name detected"; pcre:"(?i)\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|iel(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|setting|time(?:stamp)?|user)))|d(?:a(?:t(?:abase(?:_to_xml)?|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t(?:_(?:format|lock)|pgusername))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|superuser)|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|inser_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:_(?:from_bytea|put)|ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|(?:databas|read_fil)e|l(?:argeobject|s_dir)|sleep|user)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ery_to_xml|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[12]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\("; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942152; rev:1;)
alert any any any -> any any (msg:"Detects MySQL and PostgreSQL stored procedure/function injections"; pcre:"(?i)create[\s\x0b]+(?:function|procedure)[\s\x0b]*?[0-9A-Z_a-z]+[\s\x0b]*?\([\s\x0b]*?\)[\s\x0b]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\s\x0b]*?[0-9A-Z_a-z]+|iv[\s\x0b]*?\([\+\-]*[\s\x0b\.0-9]+,[\+\-]*[\s\x0b\.0-9]+\))|exec[\s\x0b]*?\([\s\x0b]*?@|(?:lo_(?:impor|ge)t|procedure[\s\x0b]+analyse)[\s\x0b]*?\(|;[\s\x0b]*?(?:declare|open)[\s\x0b]+[\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\s\x0b]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942321; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-2]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942015; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-2]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942016; rev:1;)
alert any any any -> any any (msg:"Detects HAVING injections"; pcre:"(?i)\W+\d*?\s*?\bhaving\b\s*?[^\s\-]"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942251; rev:1;)
alert any any any -> any any (msg:"Detects classic SQL injection probings 3/3"; pcre:"[\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942490; rev:1;)
alert any any any -> any any (msg:"Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)"; pcre:"((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942420; rev:1;)
alert any any any -> any any (msg:"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)"; pcre:"((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942431; rev:1;)
alert any any any -> any any (msg:"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters"; pcre:"\W{4}"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942460; rev:1;)
alert any any any -> any any (msg:"SQLi bypass attempt by ticks detected"; pcre:"(?:'(?:(?:[\w\s=_\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)')"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942511; rev:1;)
alert any any any -> any any (msg:"SQLi query termination detected"; pcre:"';"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942530; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-3]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942017; rev:1;)
alert any any any -> any any (msg:"None"; pcre:"^[0-3]$"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942018; rev:1;)
alert any any any -> any any (msg:"Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)"; pcre:"((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942421; rev:1;)
alert any any any -> any any (msg:"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)"; pcre:"((?:[~!@#\$%\^&\*\(\)\-\+=\{\}\[\]\|:;\"; normalize; program:; threshold:type limit,track by_src,count 1,seconds 60; classtype:; sid:942432; rev:1;)
